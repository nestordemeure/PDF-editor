<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PDF Editor</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìù</text></svg>" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <section class="section">
    <div class="container">
      <!-- Header -->
      <h1 class="title">PDF Editor</h1>
      <p class="subtitle">Minimal, in-browser cleanup for scanned books.</p>

      <!-- Loading & Saving Controls -->
      <div class="box">
        <div class="field is-grouped is-grouped-multiline">
          <div class="control">
            <div class="file is-small has-name is-info">
              <label class="file-label">
                <input id="fileInput" class="file-input" type="file" multiple accept="application/pdf" />
                <span class="file-cta">
                  <span class="file-label">Load PDFs</span>
                </span>
              </label>
            </div>
          </div>

          <div class="control">
            <div class="select is-small">
              <select id="compressionLevel">
                <option value="none">No Compression</option>
                <option value="low">Low Compression</option>
                <option value="medium">Medium Compression</option>
                <option value="high" selected>High Compression</option>
              </select>
            </div>
          </div>

          <div class="control">
            <div class="select is-small">
              <select id="ocrLang">
                <option value="none">No OCR</option>
                <option value="eng" selected>English</option>
                <option value="fra">French</option>
                <option value="deu">German</option>
                <option value="spa">Spanish</option>
                <option value="ita">Italian</option>
                <option value="por">Portuguese</option>
                <option value="nld">Dutch</option>
                <option value="cat">Catalan</option>
                <option value="pol">Polish</option>
                <option value="ces">Czech</option>
                <option value="ron">Romanian</option>
                <option value="swe">Swedish</option>
                <option value="fin">Finnish</option>
                <option value="dan">Danish</option>
                <option value="nor">Norwegian</option>
                <option value="lat">Latin</option>
                <option value="eng+fra+deu+spa+ita+por">Multi (EN/FR/DE/ES/IT/PT)</option>
              </select>
            </div>
          </div>

          <div class="control">
            <button id="saveBtn" class="button is-small is-primary">Save PDF</button>
          </div>
        </div>

        <progress id="progressBar" class="progress is-small is-info" value="0" max="100" hidden></progress>
        <p id="status" class="is-size-7 has-text-grey"></p>
      </div>

      <!-- Three Column Layout -->
      <div class="three-column-layout">
        <!-- Left Column: Page Operations -->
        <aside class="operations-sidebar">
          <div class="box">
            <h2 class="title is-6 mb-3">Selected Pages Operations</h2>

            <div class="buttons-vertical">
              <button id="rotateBtn" class="button is-small is-fullwidth is-light">Rotate 90¬∞</button>
              <button id="splitBtn" class="button is-small is-fullwidth is-light">Split Double Pages</button>
              <button id="deleteBtn" class="button is-small is-fullwidth is-light">Delete Pages</button>
              <button id="removeShadingBtn" class="button is-small is-fullwidth is-light">Remove Shading</button>

              <div class="field mt-2">
                <div class="select is-small is-fullwidth is-light">
                  <select id="colorMode">
                <option value="color">Original Colors</option>
                <option value="gray" selected>Grayscale</option>
                <option value="bw-otsu">B&amp;W (flat)</option>
                <option value="bw">B&amp;W (adaptive)</option>
              </select>
            </div>
          </div>

              <hr class="my-3" />

              <button id="undoBtn" class="button is-small is-fullwidth is-light">Undo</button>
              <button id="redoBtn" class="button is-small is-fullwidth is-light">Redo</button>
            </div>
          </div>
        </aside>

        <!-- Center Column: Pages Grid -->
        <main class="pages-main">
          <div class="box">
            <div class="level">
              <div class="level-left">
                <div class="level-item">
                  <label class="checkbox">
                    <input id="selectAll" type="checkbox" />
                    Select all
                  </label>
                </div>
              </div>
              <div class="level-right">
                <div class="level-item">
                  <span id="pageCount" class="tag">0 pages</span>
                </div>
              </div>
            </div>
            <div id="pageGrid" class="page-grid"></div>
          </div>
        </main>

        <!-- Right Column: Preview -->
        <aside class="preview-sidebar">
          <div class="box">
            <h2 class="title is-6">Preview</h2>
            <canvas id="previewCanvas" class="preview-canvas"></canvas>
            <p id="previewLabel" class="is-size-7 has-text-grey mt-2">Click a page to preview it.</p>
          </div>
        </aside>
      </div>
    </div>
  </section>

  <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pako@2.1.0/dist/pako.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/upng-js@2.1.0/UPNG.min.js"></script>
  <script async src="https://docs.opencv.org/4.x/opencv.js" onload="onOpenCvReady()"></script>
  <script type="module" src="app.js"></script>
</body>
</html>
